---
Идентификатор - [TO_BE_CREATED]
Путь к базе - [будет выделен]
Эндпоинт - [будет выдан]

---
# Разделы и таблицы

## Структура каталогов
- В рамках базы данных предусмотрены два корневых раздела:
    - `/deals` — данные по сделкам.
    - `/shifts` — данные по сменам.
- Для каждой компании создаётся подпапка: `/deals/{firm_id}` и `/shifts/{firm_id}`.
- Таблицы располагаются по путям:
    - `/deals/{firm_id}/firm_deals`
    - `/shifts/{firm_id}/firm_shifts`

Подход «таблица на компанию» упрощает раздельное хранение и настройку прав доступа.

### Раздел `/deals`

#### Таблица: `firm_deals`

| # | Имя | Ключ | Тип | Описание |
| - | --- | ---- | --- | -------- |
| 0 | `firm_id` | PK (часть 1) | `Utf8` | Идентификатор компании (`Firms.firm_id`). |
| 1 | `deal_id` | PK (часть 2) | `Utf8` | Уникальный идентификатор сделки (UUID). |
| 2 | `deal_name` | | `Utf8` | Название сделки. |
| 3 | `object_id` | | `Utf8` | Ссылка на объект (`firm_objects.object_id`). |
| 4 | `base_salary` | | `Double` | Базовая оплата (руб.) за выполненную норму. |
| 5 | `quota_amount` | | `Int32` | Минимальное количество единиц работ (норма без доплаты). |
| 6 | `price_per_unit` | | `Double` | Стоимость за единицу сверх нормы. |
| 7 | `deadline_at` | | `Optional<Timestamp>` | Жесткий крайний срок выполнения. |
| 8 | `available_from` | | `Optional<Timestamp>` | Дата/время, когда сделка становится доступной. |
| 9 | `notes` | | `Optional<Utf8>` | Дополнительное описание. |
| 10 | `metadata_json` | | `Json` | Дополнительные атрибуты сделки. |
| 11 | `created_at` | | `Timestamp` | Время создания записи. |
| 12 | `updated_at` | | `Timestamp` | Время последнего обновления. |

### Раздел `/shifts`

#### Таблица: `firm_shifts`

| # | Имя | Ключ | Тип | Описание |
| - | --- | ---- | --- | -------- |
| 0 | `firm_id` | PK (часть 1) | `Utf8` | Ссылка на компанию (`Firms.firm_id`). |
| 1 | `shift_id` | PK (часть 2) | `Utf8` | Идентификатор смены (UUID). |
| 2 | `shift_name` | | `Utf8` | Название смены. |
| 3 | `object_id` | | `Utf8` | Ссылка на объект (`firm_objects.object_id`). |
| 4 | `base_salary` | | `Double` | Базовая оплата смены (руб.). |
| 5 | `tags_json` | | `Json` | Список необходимых навыков/видов работ. |
| 6 | `available_from` | | `Optional<Timestamp>` | Дата/время начала доступности смены. |
| 7 | `deadline_at` | | `Optional<Timestamp>` | Крайний срок (может отсутствовать). |
| 8 | `notes` | | `Optional<Utf8>` | Дополнительный комментарий. |
| 9 | `metadata_json` | | `Json` | Дополнительные атрибуты смены. |
| 10 | `created_at` | | `Timestamp` | Время создания записи. |
| 11 | `updated_at` | | `Timestamp` | Время последнего обновления. |

## Индексы и замечания
- Для сделок: глобальный индекс по `available_from`, `deadline_at` для отбора активных задач.
- Для смен: аналогичный индекс по `available_from`, `deadline_at` и (опц.) по `tags_json` (secondary index) для фильтрации смен по навыкам.
- Все JSON-поля валидируются функцией `metadata-validator`.
- Таблицы создаются соответствующими сервисами управления сделками и сменами.
